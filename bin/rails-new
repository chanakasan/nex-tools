set -e

copy_template_folder() {
  local base_path="$HOME/groups/templates"
  local folder_name="$1"
  local dest="$2"
  local path1=$base_path/$folder_name
  if [ ! -d "$path1" ]; then
    echo " folder not found: $path1"
    exit 1
  fi
  rsync -a --exclude .git $path1/ $dest
}

git_commit() {
  cd "$1"
  git init
  git add .
  git commit -m "initial app from template"
}

main() {
  read -p "copy template? " value
  local app_name=$(haiku)
  local tpl_name="rails/sparkling-log-9786"

  if [[ $value == yes ]]; then
    echo "=> using db=sqlite css=tailwind js=esbuild"
    copy_template_folder $tpl_name $app_name
    git_commit $app_name
  else
    # rails new $app_name -c tailwind -j esbuild
    echo "Aborted"
  fi
}

main
